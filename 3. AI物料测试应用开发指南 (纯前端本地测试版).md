## **AI物料测试应用开发指南 (纯前端本地测试版)**

本文档为《AI物料主数据测试应用(POC)方案》提供技术实现层面的指导，旨在推荐一个**纯前端**的极简技术栈，帮助您在本地快速构建功能原型。

### **零、开发环境准备 (人工操作)**

本指南的第一步，也是最关键的一步，需要由人类开发者手动完成。AI代理无法自行注册账户或安装本地工具。请在将任务交给AI代理前，完成以下准备工作，并将获得的信息提供给AI代理。

1. **注册并创建Supabase项目**:  
   * 访问 https://supabase.com 并注册一个免费账户。  
   * 登录后，点击 "New project" 创建一个新的项目。  
2. **安装Supabase命令行工具 (CLI)**:  
   * 这是让AI代理能够自动化管理数据库的关键工具。  
   * 打开您的Windows终端 (Terminal/PowerShell) 并运行以下命令 (需要先安装 npm):  
     npm install supabase \--save-dev

3. **安装VS Code插件 (推荐)**:  
   * 为了方便您在开发过程中查看数据库和存储，建议在VS Code中安装官方的 "Supabase" 插件。  
4. **获取项目关键信息**:  
   * 在您创建的Supabase项目仪表盘中，进入 "Project Settings" \> "API"。  
   * 您需要找到并复制以下两项关键信息，用于硬编码到您的HTML文件中：  
     * **Project URL**: 您的项目的唯一API端点。  
     * **service\_role secret key**: **对于本次本地测试**，我们将直接使用这个拥有完全权限的密钥，以简化开发。**请注意，这种做法仅限于绝不公开部署的本地测试环境。**  
5. **获取Gemini API Key**:  
   * 访问 https://aistudio.google.com/app/apikey 获取您的Gemini API密钥。  
   * 这个密钥也将被直接硬编码到您的HTML文件中。  
6. **将信息交给AI代理**:  
   * 当您启动AI代理时，需要将上述获取的 **Project URL**, **service\_role key**, 和 **Gemini API Key** 作为配置参数提供给它。这样，AI代理生成的代码才能正确地连接到所有服务。

完成以上步骤后，您的开发环境就准备就绪了，可以放心地将后续的编码和部署任务交给您的AI编程代理。

### **一、 推荐的极简技术栈 (纯前端)**

| 类别 | 技术选型 | 推荐理由 |
| :---- | :---- | :---- |
| **前端 (Frontend)** | **原生 HTML \+ CSS \+ JavaScript** | 无需编译，无框架学习成本，直接在浏览器运行，是原型开发的最快方式。 |
| **数据库** | **Supabase (使用 pgvector)** | **一站式解决核心难题**。它提供免费的PostgreSQL数据库，并原生支持pgvector扩展，可高效进行向量搜索。 |
| **图片存储** | **Supabase Storage** | 与Supabase数据库无缝集成，提供简单的文件上传和URL管理，无需配置额外的服务。 |
| **AI服务** | **Google AI (Gemini API)** | 前端通过fetch直接调用Google的API，进行文本分析和向量生成。 |

### **二、 前端实现 (All-in-One HTML)**

由于没有后端，所有的逻辑都将集中在一个HTML文件中。这包括与Supabase和Gemini API的直接通信。

**index.html 示例代码结构:**

\<\!DOCTYPE html\>  
\<html lang="zh-CN"\>  
\<head\>  
    \<meta charset="UTF-8"\>  
    \<title\>AI物料测试平台\</title\>  
    \<\!-- 引入Supabase的JS库 \--\>  
    \<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"\>\</script\>  
\</head\>  
\<body\>  
    \<h1\>AI物料测试平台\</h1\>  
    \<\!-- 这里是您的应用UI界面 \--\>

    \<script\>  
        // \--- 1\. 硬编码配置 \---  
        const SUPABASE\_URL \= 'YOUR\_SUPABASE\_PROJECT\_URL'; // 粘贴您的Project URL  
        const SUPABASE\_SERVICE\_KEY \= 'YOUR\_SUPABASE\_SERVICE\_ROLE\_KEY'; // 粘贴您的service\_role key  
        const GEMINI\_API\_KEY \= 'YOUR\_GEMINI\_API\_KEY'; // 粘贴您的Gemini API Key

        // \--- 2\. 初始化Supabase客户端 \---  
        // 注意：我们直接使用service\_role key，这仅限于安全的本地测试环境  
        const supabase \= supabase.createClient(SUPABASE\_URL, SUPABASE\_SERVICE\_KEY);

        // \--- 3\. 与Gemini API直接交互的函数示例 \---  
        async function analyzeWithGemini(promptText) {  
            const API\_URL \= \`https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${GEMINI\_API\_KEY}\`;  
              
            try {  
                const response \= await fetch(API\_URL, {  
                    method: 'POST',  
                    headers: { 'Content-Type': 'application/json' },  
                    body: JSON.stringify({  
                        contents: \[{ parts: \[{ text: promptText }\] }\]  
                    })  
                });

                if (\!response.ok) {  
                    throw new Error(\`Gemini API请求失败: ${response.statusText}\`);  
                }  
                  
                const data \= await response.json();  
                // 在这里处理AI返回的JSON数据  
                console.log(data.candidates\[0\].content.parts\[0\].text);  
                return data.candidates\[0\].content.parts\[0\].text;

            } catch (error) {  
                console.error('调用Gemini时出错:', error);  
            }  
        }

        // \--- 4\. 与Supabase交互的函数示例 \---  
        async function saveItemToDatabase(itemData) {  
            const { data, error } \= await supabase  
                .from('Test\_ItemMaster') // 您的表名  
                .insert(\[itemData\]);

            if (error) {  
                console.error('存入Supabase时出错:', error);  
            } else {  
                console.log('存入成功:', data);  
            }  
        }

        // \--- 5\. 您的应用主逻辑 \---  
        // analyzeWithGemini("请分析这个物料：DN50法兰");

    \</script\>  
\</body\>  
\</html\>

### **三、 数据库与图片存储 (Supabase)**

为什么选择Supabase？  
因为它将传统数据库、向量数据库、文件存储三大功能整合在了一起，并且提供非常友好的免费套餐，是原型开发的完美选择。  
**设置步骤：**

1. **创建项目**: 访问 supabase.com 并创建一个新项目。 (已在第零步完成)  
2. **创建数据表**: 在项目的SQL编辑器中，根据我们方案文档中的Test\_ItemMaster, Test\_ItemAliases, Test\_BOQs结构创建数据表。  
3. **开启向量支持**: 运行一条简单的SQL命令来开启pgvector扩展：CREATE EXTENSION IF NOT EXISTS vector;  
4. **创建存储桶 (Bucket)**: 在Supabase的Storage部分，创建一个名为 item\_images 的公共存储桶，用于存放物料图片。

这个纯前端的技术栈是实现您本地测试目标的最快路径，它移除了所有不必要的中间层，让您可以直接在浏览器中验证核心的AI与数据交互逻辑。