## **智能工程仓库管理系统设计方案 (AI-Powered WMS)**

本文档旨在概述一个专为工程项目设计的、集成了先进AI能力的仓库管理系统的数据库结构与核心工作流。该方案旨在解决工程物料（BOQ）非标性强、名称不统一、需求变更频繁等行业痛点。

### **一、 核心设计理念**

1. **项目导向**: 所有物料管理活动（采购、入库、领用）都必须与具体的工程项目关联，实现端到端的成本与物料追踪。  
2. **物料标准化与灵活性分离**: 通过建立一个中央“物项主数据 (ItemMaster)”，将一个抽象的物料概念（如“钢管”）与其无穷的具体规格（材质、尺寸、标准）分离开来，实现对每一个唯一SKU的精确管理。  
3. **双BOQ架构**: 系统内为每个项目维护两个独立的BOQ库——原始BOQ库和实际BOQ库，以实现清晰的变更追溯和职责分离。  
4. **AI驱动的自动化**: 利用多模态AI（如Google Gemini）的能力，自动解析、比对、分类BOQ条目，极大提升数据处理的效率与准确性。  
5. **人机协同 (Human-in-the-loop)**: 在AI无法100%确定的模糊场景下，引入人工审核环节，确保决策的准确性，并通过用户的反馈持续优化AI模型。

### **二、 数据库核心模块设计**

#### **1\. 基础数据模块**

* **Projects (项目表)**: 管理项目基本信息。  
* **ItemMaster (物项主数据表)**: 系统的基石。定义**每一个唯一规格的物料**，包含标准主名称、完整技术规格、标准图片、文本向量和图像向量。  
* **ItemAliases (物项别名表)**: 解决“一物多名”问题。存储同一物项的各种别名、俗称、多语言名称（如：盲板、Blind Plate、dummy）。  
* **Suppliers (供应商表)**: 管理供应商信息。

#### **2\. BOQ管理模块**

* **OriginalBOQ (原始BOQ库)**: 存储客户提供的、未经技术深化的初始BOQ。AI仅对其进行\*\*“增强而不修改”\*\*，在后台添加语义向量等分析数据。  
* **ActualBOQ (实际BOQ库)**: 存储由技术部门深化设计后、可用于采购和施工的精确BOQ。

#### **3\. 库存与仓储模块**

* **Warehouses (仓库表)**: 管理物理仓库信息。  
* **Inventory (库存表)**: 实时追踪每个物项 (item\_id) 在每个仓库 (warehouse\_id) 的精确库存量和库位。

#### **4\. 业务流程模块**

* **PurchaseOrders (采购订单)**: 记录采购活动。  
* **GoodsReceipts (入库记录)**: 记录物料到货入库事件，并触发库存更新。  
* **MaterialRequisitions (领料申请)**: 记录项目现场的物料领用申请。  
* **MaterialIssues (出库记录)**: 记录物料发放出库事件，并触发库存更新。

### **三、 AI核心工作流**

#### **1\. 初始BOQ录入流程 (多模态识别)**

1. **输入**: 用户输入或上传原始BOQ中的一行文本（如 "10件 DUMMY, DN150"），并可选择性附带一张现场照片。  
2. **AI分析**: Gemini模型同时从三个维度进行分析：  
   * **文本匹配**: 在ItemAliases表中搜索关键词 "dummy"。  
   * **语义匹配**: 将输入文本转换为向量，在ItemMaster的文本向量库中搜索最相似的物项。  
   * **图像匹配**: 将用户上传的图片转换为向量，在ItemMaster的图像向量库中搜索最相似的图片。  
3. **人机协同**: 系统向用户展示最可能的匹配结果，包括标准名称、规格、**标准图片**和已知别名。  
4. **用户确认**: 用户根据AI的建议和图片，确认正确的物项。系统将该条记录存入OriginalBOQ，内部关联了正确的item\_id，但对用户显示的仍是原始文本 "DUMMY"。

#### **2\. BOQ智能比对 (Diff) 流程**

1. **触发**: 技术部门上传实际BOQ后，流程自动触发。  
2. **解析**: 系统采用与步骤一相同的AI工作流，将实际BOQ的每一行都精确地解析并关联到唯一的item\_id。  
3. **比对**: AI的核心任务转变为**直接比较两个BOQ库中的item\_id列表**。  
   * ActualBOQ有，OriginalBOQ没有的item\_id \-\> **新增项**。  
   * OriginalBOQ有，ActualBOQ没有的item\_id \-\> **删除项**。  
   * 两者共有，但数量、品牌等参数不同的item\_id \-\> **修改项**。  
4. **生成报告**: 系统生成一份清晰的BOQ变更对比报告，供项目经理和相关人员审阅。